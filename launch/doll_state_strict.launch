<launch>
  <!-- ====== ARGS (override at runtime) ====== -->
  <arg name="pkg"               default="doll_head_torso"/>
  <arg name="node_name"         default="doll_state_node_strict"/>
  <arg name="model_path"        default="$(find doll_head_torso)/weights/best.pt"/>

  <!-- Camera topics (change to your own if needed) -->
  <arg name="image_topic"        default="/camera/color/image_raw"/>
  <arg name="depth_topic"        default="/camera/aligned_depth_to_color/image_raw"/>
  <arg name="camera_info_topic"  default="/camera/color/camera_info"/>

  <!-- ====== NODE ====== -->
  <node pkg="$(arg pkg)" type="doll_state_node_strict.py" name="$(arg node_name)" output="screen">
    <!-- Model / IO -->
    <param name="model_path"       value="$(arg model_path)"/>
    <param name="image_topic"      value="$(arg image_topic)"/>
    <param name="depth_topic"      value="$(arg depth_topic)"/>
    <param name="camera_info_topic" value="$(arg camera_info_topic)"/>
    <param name="device" value="cuda:0"/>


    <!-- Use depth for strict neck continuity (set false if no depth) -->
    <param name="use_depth"        value="true"/>

    <!-- ====== BASE THRESHOLDS (from original node; tune as before) ====== -->
    <param name="mask_threshold"        value="0.5"/>
    <param name="min_conf_head"         value="0.40"/>
    <param name="min_conf_torso"        value="0.40"/>
    <param name="min_conf_ht"           value="0.55"/>
    <param name="ht_union_iou_min"      value="0.60"/>
    <param name="overlap_thresh"        value="0.30"/>
    <param name="center_dist_factor"    value="0.55"/>
    <param name="min_vertical_margin"   value="0.03"/>
    <param name="min_frames_to_assembled" value="6"/>

    <!-- ====== STRICT-ONLY PARAMS ====== -->
    <param name="neck_gap_px_max"       value="6"/>
    <param name="min_contact_px"        value="80"/>
    <param name="depth_neck_gap_max_m"  value="0.01"/>

    <!-- Debug (optional) -->
    <param name="publish_debug"         value="true"/>
  </node>
</launch>
